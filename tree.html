<div class="tree">
  <input type="search" ng-model="q">
  <ul>
    <li ng-repeat='li in tree | filter:q as results' ng-include="'tree'" ng-if="li.unitOwner"
      ng-click="click($event,li)" class="tree-element hidden">
      <span>{{li.unit.name}}</span> - {{li.unitOwner.name}}
    </li>
  </ul>
  <script type="text/ng-template" id="tree">
    <ul ng-if="li.childUnits && li.unitOwner">
      <div class="bckg-image"></div>
      <span>{{li.unit.name}}</span> - {{li.unitOwner.name}}
      <li ng-repeat="li in li.childUnits | filter:q as results" ng-if="li.unitOwner && $parent.li.flag" ng-include="'tree'"
      ng-click="click($event,li)" class="tree-element" ng-class="{hidden: !li.flag}">
      </li>
    </ul>
  </script>
</div>
